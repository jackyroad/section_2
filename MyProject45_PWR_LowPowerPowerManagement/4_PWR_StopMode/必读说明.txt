/*********************************************************************************************/

【*】 程序简介 

-工程名称：停止模式
-实验平台: 野火STM32 F429 开发板 
-MDK版本：5.16
-ST固件库版本：1.5.1

【 ！】功能简介：
学习使用停止模式降低功耗

【 ！！】注意事项：
在停止状态下，DAP下载器无法给STM32下载程序，
可按KEY1、KEY2唤醒后下载，
或按复位键使芯片处于复位状态，然后在电脑上点击下载按钮，再释放复位按键，即可下载

【 ！】实验操作：
连接串口调试助手可获取调试信息。
本程序中，绿灯表示STM32正常运行，红灯表示停止状态，蓝灯表示刚从停止状态被唤醒
本实验执行这样一个循环： ------》亮绿灯(正常运行)->亮红灯(停止模式)->按KEY1或KEY2唤醒->亮蓝灯(刚被唤醒)-----》

1.下载程序并复位
2.板子会亮绿灯
3.程序运行一段时间后自动进入停止状态(亮红灯)，在停止状态下，可使用KEY1或KEY2唤醒
4.刚唤醒时使用蓝灯指示状态

各个状态时会使用串口输出

2、3、4步骤循环

/*********************************************************************************************/

【*】 引脚分配

KEY:
两个按键均有硬件去抖，按下的时候均为高电平，不按时为低电平。

	KEY1<--->PA0
	KEY2<--->PC13

LED：
RGB彩灯的三个阴极接到STM32三个引脚上，LED低电平亮。

	R<--->PH10
	G<--->PH11
	B<--->PH12
    
串口（TTL-USB TO USART）：
CH340的收发引脚与STM32的发收引脚相连。
	CH340  RXD  <----->  USART1  TX  (PA9)
	CH340  TXD  <----->  USART1  RX  (PA10)

【*】 程序相关

    (1) 初始化用于唤醒的中断按键；
    (2) 设置停止状态时的 FLASH 供电或掉电；
    (3) 选择电压调节器的工作模式并进入停止状态；
    (4) 使用按键中断唤醒芯片；
    (5) 重启 HSE 时钟，使系统完全恢复停止前的状态。
    
    在停止模式中，进一步关闭了其它所有的时钟，于是所有的外设都停止了工作，但由于其 1.2V
    区域的部分电源没有关闭，还保留了内核的寄存器、内存的信息，所以从停止模式唤醒，并重新
    开启时钟后，还可以从上次停止处继续执行代码。停止模式可以由任意一个外部中断 (EXTI) 唤
    醒。在停止模式中可以选择电压调节器为开模式或低功耗模式，可选择内部 FLASH 工作在正常
    模式或掉电模式。
    
    通过串口调试信息我们会知道刚唤醒时系统时钟使用的是 HIS 时钟，频率为 16MHz，恢复后
    的系统时钟采用 HSE 倍频后的 PLL 时钟，时钟频率为 180MHz。    
        
/*********************************************************************************************/

【*】 时钟

A.晶振：
-外部高速晶振：25MHz
-RTC晶振：32.768KHz

B.各总线运行时钟：
-系统时钟 = SYCCLK = AHB1 = 180MHz
-APB2 = 90MHz 
-APB1 = 45MHz

C.浮点运算单元：
  不使用

/*********************************************************************************************/

【*】 版本

-程序版本：1.0
-发布日期：2015-10

-版本更新说明：首次发布

/*********************************************************************************************/

【*】 联系我们

-野火官网  :https://embedfire.com
-野火论坛  :http://www.firebbs.cn
-野火商城  :https://yehuosm.tmall.com
-野火资料下载中心 :http://doc.embedfire.com/products/link

/*********************************************************************************************/